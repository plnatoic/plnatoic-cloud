{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 6, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 60, "column": 0}, "map": {"version":3,"sources":["file:///Users/phamnhat/Documents/plnatoic-cloud/src/app/api/login/route.ts"],"sourcesContent":["import { SignJWT } from 'jose';\nimport { NextResponse, NextRequest } from 'next/server';\nimport { cookies } from 'next/headers';\n\nconst SECRET_KEY = process.env.JWT_SECRET_KEY;\nconst ADMIN_PASSWORD = process.env.ADMIN_PASSWORD;\n\nif (!SECRET_KEY || !ADMIN_PASSWORD) {\n  throw new Error('Missing JWT_SECRET_KEY or ADMIN_PASSWORD in environment variables');\n}\n\nexport async function POST(request: NextRequest) {\n  const { password } = await request.json();\n\n  if (password === ADMIN_PASSWORD) {\n    // Password is correct, create a session token\n    const token = await new SignJWT({ admin: true })\n      .setProtectedHeader({ alg: 'HS256' })\n      .setIssuedAt()\n      .setExpirationTime('1h') // Token expires in 1 hour\n      .sign(new TextEncoder().encode(SECRET_KEY));\n\n    const response = NextResponse.json({ success: true });\n\n    // Set the token in a secure, http-only cookie on the response\n    response.cookies.set('session_token', token, {\n      httpOnly: true,\n      secure: process.env.NODE_ENV === 'production',\n      maxAge: 60 * 60, // 1 hour in seconds\n      path: '/',\n    });\n\n    return response;\n  } else {\n    // Password is incorrect\n    return NextResponse.json({ message: 'Invalid password' }, { status: 401 });\n  }\n}\n"],"names":[],"mappings":";;;AAAA;AACA;;;AAGA,MAAM,aAAa,QAAQ,GAAG,CAAC,cAAc;AAC7C,MAAM,iBAAiB,QAAQ,GAAG,CAAC,cAAc;AAEjD,IAAI,CAAC,cAAc,CAAC,gBAAgB;IAClC,MAAM,IAAI,MAAM;AAClB;AAEO,eAAe,KAAK,OAAoB;IAC7C,MAAM,EAAE,QAAQ,EAAE,GAAG,MAAM,QAAQ,IAAI;IAEvC,IAAI,aAAa,gBAAgB;QAC/B,8CAA8C;QAC9C,MAAM,QAAQ,MAAM,IAAI,uJAAA,CAAA,UAAO,CAAC;YAAE,OAAO;QAAK,GAC3C,kBAAkB,CAAC;YAAE,KAAK;QAAQ,GAClC,WAAW,GACX,iBAAiB,CAAC,MAAM,0BAA0B;SAClD,IAAI,CAAC,IAAI,cAAc,MAAM,CAAC;QAEjC,MAAM,WAAW,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;YAAE,SAAS;QAAK;QAEnD,8DAA8D;QAC9D,SAAS,OAAO,CAAC,GAAG,CAAC,iBAAiB,OAAO;YAC3C,UAAU;YACV,QAAQ,oDAAyB;YACjC,QAAQ,KAAK;YACb,MAAM;QACR;QAEA,OAAO;IACT,OAAO;QACL,wBAAwB;QACxB,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;YAAE,SAAS;QAAmB,GAAG;YAAE,QAAQ;QAAI;IAC1E;AACF","debugId":null}}]
}