{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///Users/phamnhat/Documents/plnatoic-cloud/src/app/admin/blog/page.tsx"],"sourcesContent":["'use client';\n\nimport { useState, useEffect, FormEvent } from 'react';\nimport { useRouter } from 'next/navigation';\n\ninterface Post {\n  slug: string;\n  title: string;\n  created_at: string;\n  content?: string; \n  image_url?: string; \n}\n\nconst initialPostData = {\n  title: '',\n  content: '',\n  imageUrl: '',\n};\n\nexport default function AdminBlogPage() {\n  const [posts, setPosts] = useState<Post[]>([]);\n  const [error, setError] = useState<string | null>(null);\n\n  // State for the form\n  const [editingPost, setEditingPost] = useState<Post | null>(null);\n  const [postData, setPostData] = useState(initialPostData);\n\n  const router = useRouter();\n\n  const fetchPosts = () => {\n    fetch('/api/posts')\n      .then(res => res.json())\n      .then(data => setPosts(data.posts))\n      .catch(() => setError('Failed to fetch posts.'));\n  };\n\n  useEffect(() => {\n    fetchPosts();\n  }, []);\n\n  // When Edit is clicked, populate the form with the post's data\n  const handleEdit = (post: Post) => {\n    setEditingPost(post);\n    // Also fetch the full content\n     fetch(`/api/posts/${post.slug}`)\n      .then(res => res.json())\n      .then(fullPost => {\n        setPostData({\n          title: fullPost.title || '',\n          content: fullPost.content || '',\n          imageUrl: fullPost.image_url || '',\n        });\n      })\n      .catch(() => setError('Failed to fetch post content.'));\n  };\n\n  const handleDelete = async (slug: string) => {\n    if (window.confirm('Are you sure you want to delete this post?')) {\n      try {\n        const res = await fetch(`/api/posts/${slug}`, { method: 'DELETE' });\n        if (!res.ok) {\n          const errorData = await res.json();\n          throw new Error(errorData.error || 'Failed to delete post');\n        }\n        fetchPosts(); // Refresh list\n      } catch (err) {\n        alert(err instanceof Error ? err.message : 'An unknown error occurred');\n      }\n    }\n  };\n\n  const handleFormSubmit = async (e: FormEvent) => {\n    e.preventDefault();\n    const method = editingPost ? 'PUT' : 'POST';\n    const url = editingPost ? `/api/posts/${editingPost.slug}` : '/api/posts';\n    const body = JSON.stringify({ \n      title: postData.title, \n      content: postData.content, \n      imageUrl: postData.imageUrl \n    });\n\n    try {\n      const res = await fetch(url, {\n        method,\n        headers: { 'Content-Type': 'application/json' },\n        body,\n      });\n\n      if (!res.ok) {\n        const errorData = await res.json();\n        throw new Error(errorData.error || 'Failed to save post');\n      }\n      \n      handleCancelEdit(); // Reset form\n      fetchPosts(); // Refresh list\n    } catch (err) {\n      alert(err instanceof Error ? err.message : 'An unknown error occurred');\n    }\n  };\n\n  // Reset form to its initial state\n  const handleCancelEdit = () => {\n    setEditingPost(null);\n    setPostData(initialPostData);\n  };\n\n  const handleLogout = async () => {\n    try {\n      await fetch('/api/logout', { method: 'POST' });\n      router.push('/admin/login');\n    } catch (err) {\n      alert('Logout failed.');\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gray-900 text-white p-8\">\n      <div className=\"max-w-4xl mx-auto\">\n        <div className=\"flex justify-between items-center mb-8\">\n          <h1 className=\"text-3xl font-bold\">Admin - Blog Posts</h1>\n          <button onClick={handleLogout} className=\"bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded\">\n            Logout\n          </button>\n        </div>\n\n        {error && <p className=\"text-red-500 bg-red-900 p-3 rounded-md\">{error}</p>}\n\n        <div className=\"mb-8 p-4 border rounded-lg bg-gray-900\">\n          <h2 className=\"text-xl font-semibold mb-2\">{editingPost ? 'Edit Post' : 'Create New Post'}</h2>\n          <form onSubmit={handleFormSubmit}>\n            <div className=\"mb-4\">\n              <label htmlFor=\"title\" className=\"block mb-1 font-medium\">Title</label>\n              <input\n                id=\"title\"\n                type=\"text\"\n                value={postData.title}\n                onChange={(e) => setPostData({ ...postData, title: e.target.value })}\n                className=\"w-full p-2 border rounded bg-gray-800 text-white border-gray-600 focus:ring-blue-500 focus:border-blue-500\"\n                required\n              />\n            </div>\n            <div className=\"mb-4\">\n              <label htmlFor=\"imageUrl\" className=\"block mb-1 font-medium\">Image URL</label>\n              <input\n                id=\"imageUrl\"\n                type=\"text\"\n                placeholder=\"https://example.com/image.png\"\n                value={postData.imageUrl}\n                onChange={(e) => setPostData({ ...postData, imageUrl: e.target.value })}\n                className=\"w-full p-2 border rounded bg-gray-800 text-white border-gray-600 focus:ring-blue-500 focus:border-blue-500\"\n              />\n            </div>\n            <div className=\"mb-4\">\n              <label htmlFor=\"content\" className=\"block mb-1 font-medium\">Content (Markdown)</label>\n              <textarea\n                id=\"content\"\n                value={postData.content}\n                onChange={(e) => setPostData({ ...postData, content: e.target.value })}\n                className=\"w-full p-2 border rounded h-64 bg-gray-800 text-white border-gray-600 focus:ring-blue-500 focus:border-blue-500\"\n                required\n              />\n            </div>\n            <div className=\"flex justify-end space-x-4\">\n              {editingPost && (\n                <button type=\"button\" onClick={handleCancelEdit} className=\"bg-gray-600 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded\">\n                  Cancel\n                </button>\n              )}\n              <button type=\"submit\" className=\"bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded\">\n                {editingPost ? 'Update Post' : 'Create Post'}\n              </button>\n            </div>\n          </form>\n        </div>\n\n        <div className=\"space-y-4\">\n          {posts.map(post => (\n            <div key={post.slug} className=\"p-4 border rounded-lg bg-gray-800 flex justify-between items-center\">\n              <div>\n                <h3 className=\"text-lg font-semibold\">{post.title}</h3>\n                <p className=\"text-sm text-gray-400\">{new Date(post.created_at).toLocaleDateString()}</p>\n              </div>\n              <div className=\"space-x-2\">\n                <button onClick={() => handleEdit(post)} className=\"bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-1 px-3 rounded\">\n                  Edit\n                </button>\n                <button onClick={() => handleDelete(post.slug)} className=\"bg-red-500 hover:bg-red-600 text-white font-bold py-1 px-3 rounded\">\n                  Delete\n                </button>\n              </div>\n            </div>\n          ))}\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 395, "column": 0}, "map": {"version":3,"sources":["file:///Users/phamnhat/Documents/plnatoic-cloud/node_modules/next/navigation.js"],"sourcesContent":["module.exports = require('./dist/client/components/navigation')\n"],"names":[],"mappings":"AAAA,OAAO,OAAO","ignoreList":[0],"debugId":null}}]
}